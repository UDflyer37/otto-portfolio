<html><head><base href="https://ottoportfolio.anvil.app/">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Challenge 3: Binary Buster</title>
<style>
    body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f4f4f4;
    }
    h1, h2 {
        color: #2c3e50;
    }
    pre {
        background-color: #ecf0f1;
        padding: 15px;
        border-radius: 5px;
        overflow-x: auto;
    }
    .warning {
        background-color: #ffeb3b;
        padding: 10px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    #keyInput {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
    }
    #submitKey, #downloadCode {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        margin-right: 10px;
    }
    #submitKey:hover, #downloadCode:hover {
        background-color: #2980b9;
    }
    #result {
        margin-top: 20px;
        font-weight: bold;
    }
</style>
</head>
<body>
    <h1>Challenge 3: "Kung Pow: Enter the Code"</h1>
    
    <div class="warning">
        <strong>Note:</strong> This is a simulated challenge. Running the code on your local device will not connect with the server to verify the key. You must input the correct key into the prompt below to recieve the flag.
    </div>

    <h2>Challenge Description</h2>
    <p>Your task is to reverse engineer the provided C code and uncover the correct key to unlock the flag. (Capitalization counts here!)</p>

    <h2>Key Submission</h2>
    <input type="text" id="keyInput" placeholder="Enter the key">
    <button id="submitKey">Submit Key</button>
    <button id="downloadCode">Download C Code</button>

    <div id="result"></div>

    <h2>C Code</h2>
    <pre>
#include <stdio.h>
#include <string.h>
#include <curl/curl.h>

void generate_key(char *key) {
    int i;
    
    int base_values[] = {96, 101, 118, 120, 127};  

    for (i = 0; i < 5; i++) {
        base_values[i] = base_values[i] + 3;
        base_values[i] = base_values[i] * 2;
        base_values[i] = base_values[i] / 2;
        base_values[i] = base_values[i] - (i * 2);
        base_values[i] = base_values[i] - 1;
    }

    for (i = 0; i < 5; i++) {
        key[i] = (char)base_values[i];
    }
    key[5] = '\0';
}

int validate_key(char *key) {
    CURL *curl;
    CURLcode res;
    int is_valid = 0;
    
    curl = curl_easy_init();
    if(curl) {
        char post_data[50];
        sprintf(post_data, "key=%s", key);

        curl_easy_setopt(curl, CURLOPT_URL, "https://fake-server.com/validate");

        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, post_data);

        res = curl_easy_perform(curl);
        if(res == CURLE_OK) {
            printf("Server validation succeeded!\n");
            is_valid = 1;
        } else {
            printf("Server validation failed: %s\n", curl_easy_strerror(res));
        }

        curl_easy_cleanup(curl);
    }
    
    return is_valid;
}

int main() {
    char input[100];
    char correct_key[6];

    generate_key(correct_key);

    printf("Enter the secret key: ");
    scanf("%s", input);

    if (strcmp(input, correct_key) == 0) {
        if (validate_key(correct_key)) {
            printf("Correct! The flag will be sent by the server.\n");
        } else {
            printf("Server validation failed.\n");
        }
    } else {
        printf("Incorrect key. Try again.\n");
    }

    return 0;
}
    </pre>

    <script>
    document.getElementById('submitKey').addEventListener('click', function() {
        var key = document.getElementById('keyInput').value;
        var result = document.getElementById('result');
        
        if (key === "betty") {
            result.textContent = "Correct! The flag is: i_need_gopherchucks";
            result.style.color = "green";
        } else {
            result.textContent = "Incorrect key. Try again.";
            result.style.color = "red";
        }
    });

    document.getElementById('downloadCode').addEventListener('click', function() {
        var cCode = `
#include <stdio.h>
#include <string.h>
#include <curl/curl.h>

void generate_key(char *key) {
    int i;
    
    int base_values[] = {96, 101, 118, 120, 127};  

    for (i = 0; i < 5; i++) {
        base_values[i] = base_values[i] + 3;
        base_values[i] = base_values[i] * 2;
        base_values[i] = base_values[i] / 2;
        base_values[i] = base_values[i] - (i * 2);
        base_values[i] = base_values[i] - 1;
    }

    for (i = 0; i < 5; i++) {
        key[i] = (char)base_values[i];
    }
    key[5] = '\0';
}

int validate_key(char *key) {
    CURL *curl;
    CURLcode res;
    int is_valid = 0;
    
    curl = curl_easy_init();
    if(curl) {
        char post_data[50];
        sprintf(post_data, "key=%s", key);

        curl_easy_setopt(curl, CURLOPT_URL, "https://fake-server.com/validate");

        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, post_data);

        res = curl_easy_perform(curl);
        if(res == CURLE_OK) {
            printf("Server validation succeeded!\n");
            is_valid = 1;
        } else {
            printf("Server validation failed: %s\n", curl_easy_strerror(res));
        }

        curl_easy_cleanup(curl);
    }
    
    return is_valid;
}

int main() {
    char input[100];
    char correct_key[6];

    generate_key(correct_key);

    printf("Enter the secret key: ");
    scanf("%s", input);

    if (strcmp(input, correct_key) == 0) {
        if (validate_key(correct_key)) {
            printf("Correct! The flag will be sent by the server.\n");
        } else {
            printf("Server validation failed.\n");
        }
    } else {
        printf("Incorrect key. Try again.\n");
    }

    return 0;
}`;
        
        var blob = new Blob([cCode], {type: "text/plain"});
        var url = URL.createObjectURL(blob);
        var a = document.createElement("a");
        a.href = url;
        a.download = "challenge3.c";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    });
    </script>

</body>
</html>
